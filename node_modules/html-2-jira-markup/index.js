const converter = (htmlString) => {
    var jiraString = htmlString;
    console.log(jiraString)
    console.log(typeof(jiraString))
    jiraString = jiraString.split("<h1>").join("h1.");
    jiraString = jiraString.split("<h2>").join("h2.");
    jiraString = jiraString.split("<h3>").join("h3.");
    jiraString = jiraString.split("<h4>").join("h4.");
    jiraString = jiraString.split("<h5>").join("h5.");
    jiraString = jiraString.split("<h6>").join("h6.");
    jiraString = jiraString.split("</h1>").join("");
    jiraString = jiraString.split("</h2>").join("");
    jiraString = jiraString.split("</h3>").join("");
    jiraString = jiraString.split("</h4>").join("");
    jiraString = jiraString.split("</h5>").join("");
    jiraString = jiraString.split("</h6>").join("");
    jiraString = jiraString.split("<p>").join("\\ \\");        //replace("<p>"g, "\\ \\");
    jiraString = jiraString.split("</p>").join("");
    jiraString = jiraString.split("<i>").join("_");                           // replace("<i>"g, "_");
    jiraString = jiraString.split("</i>").join("_");                //replace("</i>"g, "_");
    jiraString = jiraString.split("<em>").join("_");//replace("<em>"g, "_");
    jiraString = jiraString.split("</em>").join("_");//replace("</em>"g, "_");
    jiraString = jiraString.split("<b>").join("*");//replace("<b>"g, "*");
    jiraString = jiraString.split("</b>").join("*");//replace("</b>"g, "*");
    jiraString = jiraString.split("<strong>").join("*");//replace("<strong"g, "*");
    jiraString = jiraString.split("</strong>").join("*");//replace("</strong>"g, "*");
    jiraString = jiraString.split("<u>").join("+");//replace("<u>"g, "+");
    jiraString = jiraString.split("</u>").join("+");//replace("</u>"g, "+");
    jiraString = jiraString.split("<ins>").join("+");//replace("<ins>"g, "+");
    jiraString = jiraString.split("</ins>").join("+");//replace("</ins>"g, "+");
    jiraString = jiraString.split("<sup>").join("^");//replace("<sup>"g, "^");
    jiraString = jiraString.split("</sup>").join("^");//replace("</sup>"g, "^");
    jiraString = jiraString.split("<sub").join("~");//replace("<sub>"g, "~");
    jiraString = jiraString.split("</sub>").join("~");//replace("</sub>"g, "~");
    jiraString = jiraString.split("<tt>").join("{{");//replace("<tt>"g, "{{");
    jiraString = jiraString.split("</tt>").join("}}");//replace("</tt>"g, "}}");
    jiraString = jiraString.split("<blockquote>").join("quote");//replace("<blockquote>"g, "{quote}");
    jiraString = jiraString.split("</blockquote>").join("{quote}");//replace("</blockquote>"g, "{quote}");
    jiraString = jiraString.split("<br>").join("\\ \\");//replace("</br>"g, "\\ \\");
    jiraString = jiraString.split("</u>").join("\\ \\");//replace("<br>"g, "\\ \\");
    jiraString = jiraString.split("<br/>").join("\\ \\");//replace("<br/>"g, "\\ \\");
    jiraString = jiraString.split("<br />").join("\\ \\");//replace("<br />"g, "\\ \\");
    jiraString = jiraString.split("<\n>").join("\\");//replace("\n"g, "\\");
    jiraString = jiraString.split("<pre>").join("{code}");//replace("<pre>"g, "{code}");
    jiraString = jiraString.split("</pre>").join("{code}");//replace(/</pre>/g, "{code}");
    jiraString = jiraString.split("<hr>").join("----");//replace("<hr>"g, "----");

    var pattern = "<ol>(.|\n)*?</ol>";
    var result = jiraString.match(pattern);
    var resultChanged = "";
    if (result && result.length >= 0) {
        result = result[0];
        resultChanged = result.split("<ol>").join("");//replace("<ol>"g, "");
        resultChanged = result.split("</ol>").join("");//replace("</ol>"g, "");
        resultChanged = result.split("<li>").join("*");//replace("<li>"g, "*");
        resultChanged = result.split("</li>").join("");//replace("</li>"g, "");
        jiraString = jiraString.split(result).join(resultChanged);//replace(result, resultChanged);
    }


    pattern = "<ul>(.|\n)*?</ul>";
    result = jiraString.match(pattern);
    if (result && result.length >= 0) {
        result = result[0];
        resultChanged = result.split("<ul>").join("");//replace("<ul>"g, "");
        resultChanged = result.split("</ul>").join("");//replace("</ul>"g, "");
        resultChanged = result.split("<li>").join("#");//replace("<li>"g, "#");
        resultChanged = result.split("</li>").join("");//replace("</li>"g, "");
        jiraString = jiraString.split(result).join(resultChanged);//replace(result, resultChanged);
    }

    pattern = "<tr>(.|\n)*?<th(.|\n)*?</tr>";
    result = jiraString.match(pattern);
    if (result && result.length >= 0) {
        result = result[0];
        resultChanged = result.split("<tr>").join("");//replace("<tr>"g, "");
        resultChanged = result.split("<th>").join("||");//replace("<th>"g, "||");
        resultChanged = result.split("</th>").join("");//replace("</th>"g, "");
        resultChanged = result.split("</tr>").join("||\\");//replace("</tr>"g, "||\\");
        jiraString = jiraString.split(result).join(resultChanged);//replace(result, resultChanged);
    }

    pattern = "<tr>(.|\n)*?<td(.|\n)*?</tr>";
    result = jiraString.match(pattern);
    if (result && result.length >= 0) {
        result = result[0];
        resultChanged = result.split("<tr>").join("");//replace("<tr>"g, "");
        resultChanged = result.split("<td>").join("|");//replace("<td>"g, "|");
        resultChanged = result.split("</td>").join("");//replace("</td>"g, "");
        resultChanged = result.split("</tr>").join("|\\");//replace("</tr>"g, "|\\");
        jiraString = jiraString.split(result).join(resultChanged);//replace(result, resultChanged);
    }

    return jiraString;
};

const ignoreEmptyHtmlTags=(tag, jiraString, replaceWith)=>
{
    var pattern = String.Format("<{0}>(.|\n)*?</{1}>", tag, tag);
    var result = jiraString.match(pattern);
    var resultChanged = "";
    while (result != "") {
        var tagsContent = result.match("(?<=<strong>)(.*?)(?=</strong>)");
        if (!/\S/.test(tagsContent)) { // if tagsContent empty or have only white spaces
            resultChanged = result.split("<{0}> ",tag).join("");//replace(('<{0}> 'g, tag), "");
            resultChanged = resultChanged.split("<{0}>",tag).join("");//replace(('<{0}>'g, tag), "");
            resultChanged = resultChanged.split(' </{0}',tag).join("");//replace((' </{0}>'g, tag), "");
            resultChanged = resultChanged.split('</{0}>',tag).join("");//replace(('</{0}>'g, tag), "");
            jiraString = jiraString.split(result).join(resultChanged);//replace(result, resultChanged);
        }
        else {
            resultChanged = result.split("<{0}> ",tag).join(replaceWith);//replace(('<{0}> 'g, tag), replaceWith);
            resultChanged = resultChanged.split("<{0}>",tag).join(replaceWith);//replace(('<{0}>'g, tag), replaceWith);
            resultChanged = resultChanged.split(" </{0}>",tag).join(replaceWith);//replace((/</{0}>/g, tag), replaceWith);
            resultChanged = resultChanged.split("<{0}>",tag).join(replaceWith);//replace(/</{0}>/g, tag), replaceWith);
            jiraString = jiraString.split(result).join(resultChanged);//replace(/result/g, resultChanged);
        }
        result = jiraString.match(pattern);
    }

    return jiraString;
}

module.exports = { converter };







// const converter = (htmlString) => {
//     var jiraString = htmlString;
//     console.log(jiraString)
//     console.log(typeof(jiraString))
//     jiraString = jiraString.replace(/<h1>/g, "h1.");
//     jiraString = jiraString.replace("<h2>", "h2");
//     jiraString = jiraString.replaceAll("<h3>", "h3.");
//     jiraString = jiraString.replaceAll("<h4>", "h4.");
//     jiraString = jiraString.replaceAll("<h5>", "h5.");
//     jiraString = jiraString.replaceAll("<h6>", "h6.");
//     jiraString = jiraString.replaceAll("</h1>", "");
//     jiraString = jiraString.replaceAll("</h2>", "");
//     jiraString = jiraString.replaceAll("</h3>", "");
//     jiraString = jiraString.replaceAll("</h4>", "");
//     jiraString = jiraString.replaceAll("</h5>", "");
//     jiraString = jiraString.replaceAll("</h6>", "");
//     jiraString = jiraString.replaceAll("<p>", "\\ \\");
//     jiraString = jiraString.replaceAll("</p>", "");
//     jiraString = jiraString.replaceAll("<i>", "_");
//     jiraString = jiraString.replaceAll("</i>", "_");
//     jiraString = jiraString.replaceAll("<em>", "_");
//     jiraString = jiraString.replaceAll("</em>", "_");
//     jiraString = jiraString.replaceAll("<b>", "*");
//     jiraString = jiraString.replaceAll("</b>", "*");
//     jiraString = jiraString.replaceAll("<strong", "*");
//     jiraString = jiraString.replaceAll("</strong>", "*");
//     jiraString = jiraString.replaceAll("<u>", "+");
//     jiraString = jiraString.replaceAll("</u>", "+");
//     jiraString = jiraString.replaceAll("<ins>", "+");
//     jiraString = jiraString.replaceAll("</ins>", "+");
//     jiraString = jiraString.replaceAll("<sup>", "^");
//     jiraString = jiraString.replaceAll("</sup>", "^");
//     jiraString = jiraString.replaceAll("<sub>", "~");
//     jiraString = jiraString.replaceAll("</sub>", "~");
//     jiraString = jiraString.replaceAll("<tt>", "{{");
//     jiraString = jiraString.replaceAll("</tt>", "}}");
//     jiraString = jiraString.replaceAll("<blockquote>", "{quote}");
//     jiraString = jiraString.replaceAll("</blockquote>", "{quote}");
//     jiraString = jiraString.replaceAll("</br>", "\\ \\");
//     jiraString = jiraString.replaceAll("<br>", "\\ \\");
//     jiraString = jiraString.replaceAll("<br/>", "\\ \\");
//     jiraString = jiraString.replaceAll("<br />", "\\ \\");
//     jiraString = jiraString.replaceAll("\n", "\\");
//     jiraString = jiraString.replaceAll("<pre>", "{code}");
//     jiraString = jiraString.replaceAll("</pre>", "{code}");
//     jiraString = jiraString.replaceAll("<hr>", "----");

//     var pattern = "<ol>(.|\n)*?</ol>";
//     var result = jiraString.match(pattern);
//     var resultChanged = "";
//     if (result && result.length >= 0) {
//         result = result[0];
//         resultChanged = result.replaceAll("<ol>", "");
//         resultChanged = result.replaceAll("</ol>", "");
//         resultChanged = result.replaceAll("<li>", "*");
//         resultChanged = result.replaceAll("</li>", "");
//         jiraString = jiraString.replaceAll(result, resultChanged);
//     }


//     pattern = "<ul>(.|\n)*?</ul>";
//     result = jiraString.match(pattern);
//     if (result && result.length >= 0) {
//         result = result[0];
//         resultChanged = result.replaceAll("<ul>", "");
//         resultChanged = result.replaceAll("</ul>", "");
//         resultChanged = result.replaceAll("<li>", "#");
//         resultChanged = result.replaceAll("</li>", "");
//         jiraString = jiraString.replaceAll(result, resultChanged);
//     }

//     pattern = "<tr>(.|\n)*?<th(.|\n)*?</tr>";
//     result = jiraString.match(pattern);
//     if (result && result.length >= 0) {
//         result = result[0];
//         resultChanged = result.replaceAll("<tr>", "");
//         resultChanged = result.replaceAll("<th>", "||");
//         resultChanged = result.replaceAll("</th>", "");
//         resultChanged = result.replaceAll("</tr>", "||\\");
//         jiraString = jiraString.replaceAll(result, resultChanged);
//     }

//     pattern = "<tr>(.|\n)*?<td(.|\n)*?</tr>";
//     result = jiraString.match(pattern);
//     if (result && result.length >= 0) {
//         result = result[0];
//         resultChanged = result.replaceAll("<tr>", "");
//         resultChanged = result.replaceAll("<td>", "|");
//         resultChanged = result.replaceAll("</td>", "");
//         resultChanged = result.replaceAll("</tr>", "|\\");
//         jiraString = jiraString.replaceAll(result, resultChanged);
//     }

//     return jiraString;
// };

// const ignoreEmptyHtmlTags=(tag, jiraString, replaceWith)=>
// {
//     var pattern = String.Format("<{0}>(.|\n)*?</{1}>", tag, tag);
//     var result = jiraString.match(pattern);
//     var resultChanged = "";
//     while (result != "") {
//         var tagsContent = result.match("(?<=<strong>)(.*?)(?=</strong>)");
//         if (!/\S/.test(tagsContent)) { // if tagsContent empty or have only white spaces
//             resultChanged = result.replaceAll(('<{0}> ', tag), "");
//             resultChanged = resultChanged.replaceAll(('<{0}>', tag), "");
//             resultChanged = resultChanged.replaceAll((' </{0}>', tag), "");
//             resultChanged = resultChanged.replaceAll(('</{0}>', tag), "");
//             jiraString = jiraString.replaceAll(result, resultChanged);
//         }
//         else {
//             resultChanged = result.replaceAll(('<{0}> ', tag), replaceWith);
//             resultChanged = resultChanged.replaceAll(('<{0}>', tag), replaceWith);
//             resultChanged = resultChanged.replaceAll((' </{0}>', tag), replaceWith);
//             resultChanged = resultChanged.replaceAll(('</{0}>', tag), replaceWith);
//             jiraString = jiraString.replaceAll(result, resultChanged);
//         }

//         result = jiraString.match(pattern);
//     }

//     return jiraString;
// }

// module.exports = { converter };